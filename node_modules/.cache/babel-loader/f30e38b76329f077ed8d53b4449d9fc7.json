{"ast":null,"code":"import Web3 from 'web3';\nimport ContractInterface from '../build/contracts/Wikipedia.json';\nimport { connectEthereum } from '../store/reducers/root';\n\nconst connect = async dispatch => {\n  if (window.ethereum) {\n    window.web3 = new Web3(window.ethereum);\n\n    try {\n      const [account] = await window.ethereum.enable();\n      const contract = new window.web3.eth.Contract(ContractInterface.abi, ContractInterface.networks['5777'].address, {\n        from: account\n      });\n      dispatch(connectEthereum({\n        account,\n        contract\n      }));\n    } catch (error) {\n      console.error(error);\n    }\n  } else {\n    console.log('Not Dapp browser.');\n  }\n};\n\nconst addArticle = async (dispatch, getState) => {\n  const {\n    account,\n    contract\n  } = getState();\n  /*if (contract) {\n  \t  alert(\"Sending an article\")\n  \t  //await contract.methods.addArticle.sendTransaction(\"Test2\", {from: account, gas: 100000})\n      //await contract.methods.addArticle(\"Test3\").send({from: account, gas : 100000})\n      await contract.methods.addArticle(\"Test3\").send({from: account})\n      //await contract.methods.addArticle(\"Test4\").send()\n      contract.methods.getAllIds().call().then(alert)\n  }*/\n\n  if (contract && account) {\n    if (window.ethereum) {\n      //const value = window.web3.utils.toWei(valueContent.toString())\n      alert(\"In Ethereum\");\n      const value = \"Test3_eth\"; //const data = contract.methods.addArticle(value).encodeABI()\n\n      await window.web3.eth.sendTransaction({\n        from: account,\n        value: content,\n        value\n      });\n    } else {\n      alert(\"Outside Ethereum\");\n      await contract.methods.addArticle(\"Test4\").send();\n    }\n  }\n};\n\nexport { connect, addArticle };","map":{"version":3,"sources":["/home/sim/Repos/DecentralizedWiki/decentralized-wikipedia/src/services/Ethereum.js"],"names":["Web3","ContractInterface","connectEthereum","connect","dispatch","window","ethereum","web3","account","enable","contract","eth","Contract","abi","networks","address","from","error","console","log","addArticle","getState","alert","value","sendTransaction","content","methods","send"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,iBAAP,MAA8B,mCAA9B;AACA,SAASC,eAAT,QAAgC,wBAAhC;;AAEA,MAAMC,OAAO,GAAG,MAAMC,QAAN,IAAkB;AAChC,MAAIC,MAAM,CAACC,QAAX,EAAqB;AACnBD,IAAAA,MAAM,CAACE,IAAP,GAAc,IAAIP,IAAJ,CAASK,MAAM,CAACC,QAAhB,CAAd;;AACA,QAAI;AACF,YAAM,CAACE,OAAD,IAAY,MAAMH,MAAM,CAACC,QAAP,CAAgBG,MAAhB,EAAxB;AACA,YAAMC,QAAQ,GAAG,IAAIL,MAAM,CAACE,IAAP,CAAYI,GAAZ,CAAgBC,QAApB,CACfX,iBAAiB,CAACY,GADH,EAEfZ,iBAAiB,CAACa,QAAlB,CAA2B,MAA3B,EAAmCC,OAFpB,EAGf;AAAEC,QAAAA,IAAI,EAAER;AAAR,OAHe,CAAjB;AAKAJ,MAAAA,QAAQ,CAACF,eAAe,CAAC;AAAEM,QAAAA,OAAF;AAAWE,QAAAA;AAAX,OAAD,CAAhB,CAAR;AACD,KARD,CAQE,OAAOO,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACD;AACF,GAbD,MAaO;AACLC,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACD;AACF,CAjBD;;AAmBA,MAAMC,UAAU,GAAG,OAAOhB,QAAP,EAAiBiB,QAAjB,KAA8B;AAC/C,QAAM;AAAEb,IAAAA,OAAF;AAAWE,IAAAA;AAAX,MAAwBW,QAAQ,EAAtC;AACA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEE,MAAIX,QAAQ,IAAIF,OAAhB,EAAyB;AACxB,QAAIH,MAAM,CAACC,QAAX,EAAqB;AACrB;AACAgB,MAAAA,KAAK,CAAC,aAAD,CAAL;AACA,YAAMC,KAAK,GAAG,WAAd,CAHqB,CAIrB;;AACA,YAAMlB,MAAM,CAACE,IAAP,CAAYI,GAAZ,CAAgBa,eAAhB,CAAgC;AAAER,QAAAA,IAAI,EAAER,OAAR;AAAiBe,QAAAA,KAAK,EAAGE,OAAzB;AAAkCF,QAAAA;AAAlC,OAAhC,CAAN;AACD,KANC,MAMK;AACLD,MAAAA,KAAK,CAAC,kBAAD,CAAL;AACG,YAAMZ,QAAQ,CAACgB,OAAT,CAAiBN,UAAjB,CAA4B,OAA5B,EAAqCO,IAArC,EAAN;AACJ;AACC;AACF,CAvBD;;AAyBA,SAASxB,OAAT,EAAmBiB,UAAnB","sourcesContent":["import Web3 from 'web3'\nimport ContractInterface from '../build/contracts/Wikipedia.json'\nimport { connectEthereum } from '../store/reducers/root'\n\nconst connect = async dispatch => {\n  if (window.ethereum) {\n    window.web3 = new Web3(window.ethereum)\n    try {\n      const [account] = await window.ethereum.enable()\n      const contract = new window.web3.eth.Contract(\n        ContractInterface.abi,\n        ContractInterface.networks['5777'].address,\n        { from: account }\n      )\n      dispatch(connectEthereum({ account, contract }))\n    } catch (error) {\n      console.error(error)\n    }\n  } else {\n    console.log('Not Dapp browser.')\n  }\n}\n\nconst addArticle = async (dispatch, getState) => {\n  const { account, contract } = getState()\n  /*if (contract) {\n  \t  alert(\"Sending an article\")\n  \t  //await contract.methods.addArticle.sendTransaction(\"Test2\", {from: account, gas: 100000})\n      //await contract.methods.addArticle(\"Test3\").send({from: account, gas : 100000})\n      await contract.methods.addArticle(\"Test3\").send({from: account})\n      //await contract.methods.addArticle(\"Test4\").send()\n      contract.methods.getAllIds().call().then(alert)\n  }*/\n  \n  if (contract && account) {\n  \tif (window.ethereum) {\n\t  //const value = window.web3.utils.toWei(valueContent.toString())\n\t  alert(\"In Ethereum\")\n\t  const value = \"Test3_eth\"\n\t  //const data = contract.methods.addArticle(value).encodeABI()\n\t  await window.web3.eth.sendTransaction({ from: account, value : content, value })\n\t} else {\n\t  alert(\"Outside Ethereum\")\n      await contract.methods.addArticle(\"Test4\").send()\n\t}\n  }\n}\n\nexport { connect , addArticle }\n"]},"metadata":{},"sourceType":"module"}